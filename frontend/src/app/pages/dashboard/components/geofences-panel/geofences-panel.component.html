<aside
  [class.translate-x-[-100%]]="isCollapsed"
  class="relative flex flex-col h-full bg-slate-900/80 backdrop-blur-xl border border-slate-700/50 rounded-3xl shadow-2xl transition-transform duration-300 ease-in-out pointer-events-auto"
>
  <button
    (click)="toggleCollapse()"
    class="absolute -right-12 top-6 w-10 h-10 bg-slate-900 border border-slate-700 rounded-xl flex items-center justify-center text-white shadow-xl hover:bg-slate-800 transition-colors"
  >
    @if (isCollapsed) {
      <svg class="chevron" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640">
        <path
          d="M471.1 297.4C483.6 309.9 483.6 330.2 471.1 342.7L279.1 534.7C266.6 547.2 246.3 547.2 233.8 534.7C221.3 522.2 221.3 501.9 233.8 489.4L403.2 320L233.9 150.6C221.4 138.1 221.4 117.8 233.9 105.3C246.4 92.8 266.7 92.8 279.2 105.3L471.2 297.3z"
        />
      </svg>
    } @else {
      <svg class="chevron" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640">
        <path
          d="M169.4 297.4C156.9 309.9 156.9 330.2 169.4 342.7L361.4 534.7C373.9 547.2 394.2 547.2 406.7 534.7C419.2 522.2 419.2 501.9 406.7 489.4L237.3 320L406.6 150.6C419.1 138.1 419.1 117.8 406.6 105.3C394.1 92.8 373.8 92.8 361.3 105.3L169.3 297.3z"
        />
      </svg>
    }
  </button>
  <div class="p-6 pb-4 space-y-4 transition-opacity duration-300" [class.opacity-0]="isCollapsed">
    <div class="flex items-center justify-between">
      <h2 class="text-xl font-bold text-white tracking-tight">Geofences</h2>
      <span
        class="px-2 py-1 text-[10px] font-black uppercase bg-slate-700 text-slate-300 rounded-md border border-slate-600"
      >
        {{ geofences.length }} totali
      </span>
    </div>
    <div class="relative">
      <input
        type="text"
        placeholder="Search area..."
        (input)="handleInput($event)"
        class="w-full bg-slate-800/50 border border-slate-700 rounded-xl py-2 pl-4 pr-4 text-sm text-slate-200 focus:outline-none focus:ring-2 focus:ring-indigo-500/50"
      />
    </div>
  </div>
  <div
    class="flex-grow overflow-y-auto px-4 space-y-2 custom-scrollbar"
    [class.hidden]="isCollapsed"
  >
    @for (fence of geofences; track fence.id) {
      <div
        (click)="selectFence(fence)"
        [style.border-left-color]="fence.metadata['color']"
        [class]="{ 'bg-white/10': selectedId === fence.id }"
        class="group relative p-4 rounded-xl bg-slate-800/30 border border-l-4 border-slate-700/50 hover:bg-slate-800/60 transition-all cursor-pointer"
      >
        <div class="flex flex-col gap-1">
          <span class="text-sm font-bold text-slate-100 uppercase tracking-tight">{{
            fence.name
          }}</span>
          <div class="flex items-center gap-2">
            <span
              class="text-[10px] px-2 py-0.5 rounded-full bg-slate-700 text-slate-400 border border-slate-600"
            >
              {{ fence.metadata['category'] }}
            </span>
          </div>
        </div>
      </div>
    } @empty {
      <div class="flex flex-col items-center justify-center h-40 text-slate-500 opacity-50">
        <span class="text-3xl mb-2">üó∫Ô∏è</span>
        <p class="text-xs italic">No geofence found</p>
      </div>
    }
  </div>
  <div class="p-6 mt-auto transition-opacity" [class.hidden]="isCollapsed">
    <button
      (click)="createNew()"
      class="w-full cursor-pointer bg-white hover:bg-slate-200 text-slate-900 font-bold py-3 rounded-2xl shadow-lg transition-all active:scale-[0.98]"
    >
      + Create Geofence
    </button>
  </div>
</aside>
